# 拷贝控制

- 当定义一个类时，我们显式地或隐式地指定在此类型的对象拷贝、移动、赋值和销毁时做什么。一个类通过定义五种特殊的成员函数来控制这些操作，包括：拷贝构造函数（copy constructor）、拷贝赋值运算符（copy-assignment operator）、移动构造函数（move constructor）、移动赋值运算符（move-assignment operator）和析构函数（destructor）。
- 拷贝和移动构造函数定义了当用同类型的另一个对象初始化本对象时做什么；拷贝和移动赋值运算符定义了将一个对象赋予同类型的另一个对象时做什么；析构函数定义了当此类型对象销毁时做什么。我们称这些操作为拷贝控制操作。

## 1. 拷贝、赋值与销毁

### 拷贝构造函数

- 如果一个构造函数的第一个参数是**自身类类型的引用**，且任何额外参数都由默认值，则此构造函数是**拷贝构造函数**。
```CPP
class Foo
{
public:
    Foo();              // 默认构造函数
    Foo(const Foo&);    // 拷贝构造函数
    // ...
}；
```

- 拷贝构造函数的第一个参数必须是一个引用类型，此参数几乎总是一个**const的引用**。拷贝构造函数在几种情况下都会被隐式地使用。因此，拷贝构造函数通常不应该是explicit的。

##### 合成拷贝构造函数

- 如果没有为类定义一个拷贝构造函数，编译器会为我们定义一个。与合成默认构造函数不同，即使我们定义了其他构造函数，编译器也会为我们合成一个拷贝构造函数。
- 对某些类来说，**合成拷贝构造函数**用来阻止我们拷贝该类类型的对象。而一般情况，合成的拷贝构造函数会将其参数的成员逐个拷贝到正在创建的对象中。编译器从给定对象中一次将每个非static成员拷贝到正在创建的对象中。
- 每个成员的类型决定了它如何拷贝：对类类型（如Sales_data）的成员，使用它自己的拷贝构造函数来拷贝；对于内置类型（如int）的成员则直接拷贝。
```CPP
class Sales_data
{
public:
    // 与合成的拷贝构造函数等价的声明
    Sales_data(const Sales_data&);
private:
    std::string bookNo;
    int units_sold = 0;
    double revenue = 0.0;
};
// 该拷贝构造函数和合成拷贝构造函数等价
Sales_data::Sales_data(const Sales_data &orig) :
    bookNo(orig.bookNo),            
    units_sold(orig.units_sold),
    revenue(orig.revenue)
    {   }                           // 空函数体
```

##### 拷贝初始化



### 拷贝赋值函数

### 析构函数

### 三／五法则

### 使用=default

### 阻止拷贝

## 2. 拷贝控制和资源管理

### 行为像值的类

### 定义行为像指针的类

## 3. 交换操作

## 4. 拷贝控制示例

## 5. 动态内存管理

## 6. 对象移动

### 右值引用

### 移动构造函数和移动赋值运算符

### 右值引用和成员函数
